# Logging System Quick Start Guide

Get your logging system up and running in minutes!

---

## 5-Minute Setup

### 1. Logging is Already Installed ‚úÖ

The logging system is fully implemented across all `.js` files. Just run your application:

```bash
npm start
```

Logs will automatically appear in the `logs/` directory.

### 2. View Logs in Real-Time

```bash
# Watch scanner logs
tail -f logs/scanner/scanner_*.log | jq '.'

# Watch all error logs
tail -f logs/*/*.log | grep '"level":"ERROR"' | jq '.'

# Watch specific stock
tail -f logs/*/*.log | grep 'RELIANCE' | jq '.'
```

### 3. Control Log Verbosity

```bash
# Show everything (including DEBUG logs)
LOG_LEVEL=DEBUG npm start

# Default (INFO and above) - recommended
LOG_LEVEL=INFO npm start

# Minimal (WARN and above only)
LOG_LEVEL=WARN npm start

# Errors only
LOG_LEVEL=ERROR npm start
```

---

## Common Tasks

### ‚úÖ Monitor a Scan in Progress

```bash
# Terminal 1: Run scan
npm start

# Terminal 2: Watch logs
watch -n 1 'tail -20 logs/scanner/scanner_2026-01-25.log | jq ".message"'
```

### ‚úÖ Find Performance Issues

```bash
# Find slowest operations
cat logs/*/*.log | jq 'select(.durationMs > 1000) | {message, durationMs}' | head -10
```

### ‚úÖ Debug Failed Stocks

```bash
# Find errors
grep '"level":"ERROR"' logs/*/*.log | jq '.message, .symbol' | head -20
```

### ‚úÖ Check Stock Scores

```bash
# View all scores
grep 'processed successfully' logs/scanner/*.log | jq '{symbol: .symbol, score: .score, classification: .classification}'
```

### ‚úÖ Analyze Cache Performance

```bash
# Cache hits
grep 'retrieved from cache' logs/data-fetcher/*.log | wc -l

# Cache misses
grep 'fetched from API' logs/data-fetcher/*.log | wc -l
```

---

## File Locations

```
Your Project
‚îú‚îÄ‚îÄ logs/                          ‚Üê All logs here (auto-created)
‚îÇ   ‚îú‚îÄ‚îÄ scanner/
‚îÇ   ‚îú‚îÄ‚îÄ indicators/
‚îÇ   ‚îú‚îÄ‚îÄ scoring/
‚îÇ   ‚îî‚îÄ‚îÄ data-fetcher/
‚îÇ
‚îú‚îÄ‚îÄ src/utils/
‚îÇ   ‚îú‚îÄ‚îÄ logger.js                 ‚Üê Core logging system
‚îÇ   ‚îú‚îÄ‚îÄ log-categories.js         ‚Üê Category definitions
‚îÇ   ‚îî‚îÄ‚îÄ index.js                  ‚Üê Exports
‚îÇ
‚îî‚îÄ‚îÄ Documentation
    ‚îú‚îÄ‚îÄ LOGGING.md                ‚Üê Complete guide
    ‚îú‚îÄ‚îÄ LOGGING_IMPLEMENTATION_SUMMARY.md  ‚Üê What was done
    ‚îî‚îÄ‚îÄ LOG_OUTPUT_EXAMPLES.md    ‚Üê Example outputs
```

---

## Add Logging to Your New Code

### For a New Function

```javascript
const { getLogger, LOG_CATEGORIES } = require('../utils');
const logger = getLogger(LOG_CATEGORIES.SCANNER);

function myNewFunction(param) {
  const startTime = Date.now();
  
  logger.info('Function called', { param });
  
  try {
    // Your code here
    const result = calculateSomething(param);
    
    const duration = Date.now() - startTime;
    logger.info('Function completed', { 
      result, 
      durationMs: duration 
    });
    
    return result;
  } catch (error) {
    logger.error('Function failed', error);
    throw error;
  }
}
```

### For a New Module

```javascript
const { getLogger, LOG_CATEGORIES } = require('../utils');

// Create logger
const logger = getLogger(LOG_CATEGORIES.YOUR_MODULE);

// Log initialization
logger.debug('Module initialized', { version: '1.0.0' });

// ... rest of your code
```

---

## Logs Generated by Main-Scanner

When you run `scanStocks()`, you'll see:

```
‚úÖ logs/scanner/scanner_2026-01-25.log

Contains:
- Scan initiation
- Universe fetching
- Market data retrieval
- Stock processing for each symbol
- Ranking and filtering
- Final results
- Any errors encountered
```

---

## Logs Generated by Indicators

When indicators are calculated:

```
‚úÖ logs/indicators/indicators_2026-01-25.log

Contains:
- EMA calculations
- RSI calculations
- MACD calculations
- ADX calculations
- Bollinger Bands calculations
- Validation errors
- Execution times
```

---

## Logs Generated by Data Fetcher

When data is fetched:

```
‚úÖ logs/data-fetcher/data-fetcher_2026-01-25.log

Contains:
- Universe fetching
- Stock data requests
- Cache hits/misses
- API calls
- Data validation
- Any fetch errors
```

---

## Example: Full Scan Trace

Run a scan and trace through the logs:

```bash
# Start scan
node demo/run-scan.js

# In another terminal, watch all logs
tail -f logs/*/*.log | jq '{time: .timestamp, level: .level, category: .category, message: .message}'

# Output shows:
# scanner: Scan initiated
# scanner: Input validation passed
# scanner: Fetching universe: NIFTY50
# scanner: Universe fetched successfully
# scanner: Market data fetched successfully
# data-fetcher: Fetching stock data RELIANCE.NS
# indicators: Calculating EMA (period 20)
# indicators: Calculating RSI (period 14)
# indicators: Calculating MACD
# scoring: Stock scoring completed
# scanner: Stock processed successfully: RELIANCE.NS
# ... (repeat for other stocks)
# scanner: Scan completed successfully
```

---

## Troubleshooting

### Q: No logs appearing in logs/ directory?

```bash
# Make sure logs directory exists
mkdir -p logs

# Run app again - logs/ will be auto-created
npm start
```

### Q: Want to see DEBUG logs?

```bash
LOG_LEVEL=DEBUG npm start
```

### Q: Logs are taking too much space?

```bash
# Delete old logs (keep last 30 days)
find logs -name "*.log" -mtime +30 -delete

# Or archive them
find logs -name "*.log" -mtime +7 -exec gzip {} \;
```

### Q: Want to search all logs?

```bash
# Find all errors
grep '"level":"ERROR"' logs/*/*.log | jq '.'

# Find specific symbol across all logs
grep 'RELIANCE' logs/*/*.log | jq '.symbol, .message'

# Count total logs
wc -l logs/*/*.log
```

---

## Log Level Defaults

| Level | When to Use | Example |
|-------|------------|---------|
| **DEBUG** | Detailed tracing | Function entry/exit, variable values |
| **INFO** | Important events | Calculations completed, scan results |
| **WARN** | Potential issues | Slow operations, cache misses |
| **ERROR** | Something failed | API errors, validation failures |

**Default**: INFO (shows everything except DEBUG)

---

## Environment Variables

```bash
# Set log level
export LOG_LEVEL=DEBUG

# Now run
npm start
```

Or inline:
```bash
LOG_LEVEL=WARN npm start
```

---

## Advanced: Parse Logs with Tools

### Using jq

```bash
# Pretty print
jq '.' logs/scanner/scanner_2026-01-25.log

# Filter by level
jq 'select(.level=="INFO")' logs/scanner/scanner_2026-01-25.log

# Extract specific fields
jq -r '[.timestamp, .message] | @csv' logs/scanner/scanner_2026-01-25.log

# Calculate stats
jq '[.[] | select(.durationMs)] | map(.durationMs) | {min: min, max: max, avg: (add/length)}'
```

### Using awk

```bash
# Count logs per level
awk -F'"' '{print $6}' logs/scanner/*.log | sort | uniq -c

# Get execution times
grep -o '"durationMs":[0-9]*' logs/scanner/*.log | awk -F: '{sum+=$2; count++} END {print sum/count}'
```

---

## Next: Explore Full Documentation

- **Complete Guide**: Read [LOGGING.md](LOGGING.md)
- **What Was Done**: See [LOGGING_IMPLEMENTATION_SUMMARY.md](LOGGING_IMPLEMENTATION_SUMMARY.md)
- **Example Output**: Check [LOG_OUTPUT_EXAMPLES.md](LOG_OUTPUT_EXAMPLES.md)
- **Reference Config**: View [config/logger-config-reference.js](config/logger-config-reference.js)

---

## Key Takeaways

‚úÖ Logging is **already implemented** across all modules
‚úÖ Logs are **automatically organized** by date and category
‚úÖ **JSON format** makes logs easy to parse
‚úÖ **Color-coded console** output for quick visual scanning
‚úÖ **Zero configuration needed** - just run and logs appear
‚úÖ **Performance tracked** on every operation

## Your Logs Are Ready to Go! üöÄ

Start using them now:
```bash
npm start
# Logs appear in logs/ directory automatically
tail -f logs/*/\*.log | jq '.'
```
